



<!DOCTYPE html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
        <meta name="description" content="Android & iOS SDK Integration">
      
      
        <link rel="canonical" href="https://kontext-hq.github.io/documentation/troubleshoot/">
      
      
        <meta name="author" content="Akshay Dekate">
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-0.17.4, mkdocs-material-2.9.2">
    
    
      
        <title>Troubleshooting - Kontext Documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.ba0fd1a6.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.6079476c.css">
      
      
        
        
        <meta name="theme-color" content="#009688">
      
    
    
      <script src="../assets/javascripts/modernizr.1aa3b519.js"></script>
    
    
      <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
      
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="teal" data-md-color-accent="teal">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#ios-sdk-setup" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href="https://kontext-hq.github.io/documentation/" title="Kontext Documentation" class="md-header-nav__button md-logo">
          
            <img src="../images/logo.png" width="24" height="24">
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            
              <span class="md-header-nav__topic">
                Kontext Documentation
              </span>
              <span class="md-header-nav__topic">
                Troubleshooting
              </span>
            
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          
            <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
            
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
          
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
        

<nav class="md-tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  <li class="md-tabs__item">
    
      <a href=".." title="Overview" class="md-tabs__link md-tabs__link--active">
        Overview
      </a>
    
  </li>

      
        
      
        
      
        
      
        
      
        
      
        
      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../android/quickstart/" title="Android" class="md-tabs__link">
          Android
        </a>
      
    </li>
  

      
        
  
  
    <li class="md-tabs__item">
      
        <a href="../iOS/quickstart/" title="iOS" class="md-tabs__link">
          iOS
        </a>
      
    </li>
  

      
    </ul>
  </div>
</nav>
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <span class="md-nav__button md-logo">
      
        <img src="../images/logo.png" width="48" height="48">
      
    </span>
    Kontext Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="Overview" class="md-nav__link">
      Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../android-quickstart/" title="Android Quickstart" class="md-nav__link">
      Android Quickstart
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../iOS-quickstart/" title="iOS Quickstart" class="md-nav__link">
      iOS Quickstart
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Troubleshooting
      </label>
    
    <a href="./" title="Troubleshooting" class="md-nav__link md-nav__link--active">
      Troubleshooting
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#required-for-setup" title="Required For Setup" class="md-nav__link">
    Required For Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-add-notification-service-extension" title="1. Add Notification Service Extension" class="md-nav__link">
    1. Add Notification Service Extension
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_1" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_2" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_3" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-import-kontext-into-your-xcode-project" title="2. Import Kontext into your Xcode project" class="md-nav__link">
    2. Import Kontext into your Xcode project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-add-required-capabilities" title="3. Add Required Capabilities" class="md-nav__link">
    3. Add Required Capabilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_4" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-add-required-code" title="4. Add Required Code" class="md-nav__link">
    4. Add Required Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-add-email" title="5. Add Email" class="md-nav__link">
    5. Add Email
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-add-app-groups-optional-but-recommended" title="6. Add App Groups (Optional but Recommended)" class="md-nav__link">
    6. Add App Groups (Optional but Recommended)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callbacks" title="Callbacks" class="md-nav__link">
    Callbacks
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../gdpr/" title="GDPR" class="md-nav__link">
      GDPR
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../terms/" title="Terms of Service" class="md-nav__link">
      Terms of Service
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../data-security/" title="Security Overview" class="md-nav__link">
      Security Overview
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-8" type="checkbox" id="nav-8">
    
    <label class="md-nav__link" for="nav-8">
      Android
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-8">
        Android
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../android/quickstart/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android/reference/" title="SDK Reference" class="md-nav__link">
      SDK Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android/firebasekey/" title="Generate Firebase Key" class="md-nav__link">
      Generate Firebase Key
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../android/troubleshoot/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
      
      
      


  <li class="md-nav__item md-nav__item--nested">
    
      <input class="md-toggle md-nav__toggle" data-md-toggle="nav-9" type="checkbox" id="nav-9">
    
    <label class="md-nav__link" for="nav-9">
      iOS
    </label>
    <nav class="md-nav" data-md-component="collapsible" data-md-level="1">
      <label class="md-nav__title" for="nav-9">
        iOS
      </label>
      <ul class="md-nav__list" data-md-scrollfix>
        
        
          
          
          


  <li class="md-nav__item">
    <a href="../iOS/quickstart/" title="Quick Start" class="md-nav__link">
      Quick Start
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iOS/reference/" title="SDK Reference" class="md-nav__link">
      SDK Reference
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iOS/push-certificate/" title="Generate an iOS Push Cert" class="md-nav__link">
      Generate an iOS Push Cert
    </a>
  </li>

        
          
          
          


  <li class="md-nav__item">
    <a href="../iOS/troubleshoot/" title="Troubleshooting" class="md-nav__link">
      Troubleshooting
    </a>
  </li>

        
      </ul>
    </nav>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#required-for-setup" title="Required For Setup" class="md-nav__link">
    Required For Setup
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#1-add-notification-service-extension" title="1. Add Notification Service Extension" class="md-nav__link">
    1. Add Notification Service Extension
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_1" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_2" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_3" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#2-import-kontext-into-your-xcode-project" title="2. Import Kontext into your Xcode project" class="md-nav__link">
    2. Import Kontext into your Xcode project
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#3-add-required-capabilities" title="3. Add Required Capabilities" class="md-nav__link">
    3. Add Required Capabilities
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image_4" title="IMAGE" class="md-nav__link">
    IMAGE
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#4-add-required-code" title="4. Add Required Code" class="md-nav__link">
    4. Add Required Code
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#5-add-email" title="5. Add Email" class="md-nav__link">
    5. Add Email
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#6-add-app-groups-optional-but-recommended" title="6. Add App Groups (Optional but Recommended)" class="md-nav__link">
    6. Add App Groups (Optional but Recommended)
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#callbacks" title="Callbacks" class="md-nav__link">
    Callbacks
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="ios-sdk-setup">iOS SDK Setup<a class="headerlink" href="#ios-sdk-setup" title="Permanent link">&para;</a></h1>
<div class="admonition tip">
<p class="admonition-title">Upgrade to 2.5.1+</p>
<p>A number the methods and classes below were recently added in our 3.5.1 SDK. Make sure you have updated to this version.</p>
</div>
<h3 id="required-for-setup">Required For Setup<a class="headerlink" href="#required-for-setup" title="Permanent link">&para;</a></h3>
<ul>
<li><a href="https://kontext.in/">A Kontext Account</a> if you do not already have one</li>
<li>Your Kontext App ID, available in <a href="https://documentation.kontext.in/docs/accounts-and-keys#section-app-id">Keys &amp; IDs</a></li>
<li>An iOS Push Certificate. <a href="../iOS/push-certificate">Generate one here</a>.</li>
<li>An iOS device (iPhone, iPad, iPod Touch) to test on. The Xcode simulator doesn't support push notifications so you must test on a real device.</li>
<li>A Mac with a new version of Xcode</li>
</ul>
<h3 id="1-add-notification-service-extension">1. Add Notification Service Extension<a class="headerlink" href="#1-add-notification-service-extension" title="Permanent link">&para;</a></h3>
<p><strong>1.1</strong> In Xcode Select <code class="codehilite">File</code> &gt; <code class="codehilite">New</code> &gt; <code class="codehilite">Target...</code></p>
<p><strong>1.2</strong> Select <code class="codehilite">Notification Service Extension</code> then press <code class="codehilite">Next</code>.</p>
<h3 id="image">IMAGE<a class="headerlink" href="#image" title="Permanent link">&para;</a></h3>
<p><strong>1.3</strong> Enter the product name as <code class="codehilite">KontextNotificationServiceExtension</code> and press <code class="codehilite">Finish</code>.</p>
<h3 id="image_1">IMAGE<a class="headerlink" href="#image_1" title="Permanent link">&para;</a></h3>
<p><strong>1.4</strong> Press Cancel on the Activate scheme prompt.</p>
<h3 id="image_2">IMAGE<a class="headerlink" href="#image_2" title="Permanent link">&para;</a></h3>
<p>By cancelling, you are keeping Xcode debugging your app, instead of just the extension. If you activate by accident, you can always switch back to debug your app within Xcode (next to the play button).</p>
<p><strong>1.5</strong> Open the Xcode project settings and select the KontextNotificationServiceExtension target. Unless you have a specific reason not to, you should set the <code class="codehilite">Deployment Target</code> to be iOS 10.</p>
<h3 id="image_3">IMAGE<a class="headerlink" href="#image_3" title="Permanent link">&para;</a></h3>
<p><strong>1.6</strong> Open <code class="codehilite">NotificationService.m</code> or <code class="codehilite">NotificationService.swift</code> and replace the whole file contents with the below code.</p>
<div class="superfences-tabs">
<input name="__tabs_1" type="radio" id="__tab_1_0" checked="checked" />
<label for="__tab_1_0">Swift</label>
<div class="superfences-content"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">import</span> <span class="nc">UserNotifications</span>

<span class="kd">import</span> <span class="nc">Kontext</span>

<span class="kd">class</span> <span class="nc">NotificationService</span><span class="p">:</span> <span class="n">UNNotificationServiceExtension</span> <span class="p">{</span>

    <span class="kd">var</span> <span class="nv">contentHandler</span><span class="p">:</span> <span class="p">((</span><span class="n">UNNotificationContent</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Void</span><span class="p">)?</span>
    <span class="kd">var</span> <span class="nv">receivedRequest</span><span class="p">:</span> <span class="n">UNNotificationRequest</span><span class="p">!</span>
    <span class="kd">var</span> <span class="nv">bestAttemptContent</span><span class="p">:</span> <span class="n">UNMutableNotificationContent</span><span class="p">?</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">didReceive</span><span class="p">(</span><span class="kc">_</span> <span class="n">request</span><span class="p">:</span> <span class="n">UNNotificationRequest</span><span class="p">,</span> <span class="n">withContentHandler</span> <span class="n">contentHandler</span><span class="p">:</span> <span class="p">@</span><span class="n">escaping</span> <span class="p">(</span><span class="n">UNNotificationContent</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="nb">Void</span><span class="p">)</span> <span class="p">{</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">receivedRequest</span> <span class="p">=</span> <span class="n">request</span><span class="p">;</span>
        <span class="kc">self</span><span class="p">.</span><span class="n">contentHandler</span> <span class="p">=</span> <span class="n">contentHandler</span>
        <span class="n">bestAttemptContent</span> <span class="p">=</span> <span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">content</span><span class="p">.</span><span class="n">mutableCopy</span><span class="p">()</span> <span class="k">as</span><span class="p">?</span> <span class="n">UNMutableNotificationContent</span><span class="p">)</span>

        <span class="k">if</span> <span class="kd">let</span> <span class="nv">bestAttemptContent</span> <span class="p">=</span> <span class="n">bestAttemptContent</span> <span class="p">{</span>
            <span class="n">Kontext</span><span class="p">.</span><span class="n">didReceiveNotificationExtensionRequest</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">receivedRequest</span><span class="p">,</span> <span class="n">with</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">bestAttemptContent</span><span class="p">)</span>
            <span class="n">contentHandler</span><span class="p">(</span><span class="n">bestAttemptContent</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="kr">override</span> <span class="kd">func</span> <span class="nf">serviceExtensionTimeWillExpire</span><span class="p">()</span> <span class="p">{</span>
        <span class="c1">// Called just before the extension will be terminated by the system.</span>
        <span class="c1">// Use this as an opportunity to deliver your &quot;best attempt&quot; at modified content, otherwise the original push payload will be used.</span>
        <span class="k">if</span> <span class="kd">let</span> <span class="nv">contentHandler</span> <span class="p">=</span> <span class="n">contentHandler</span><span class="p">,</span> <span class="kd">let</span> <span class="nv">bestAttemptContent</span> <span class="p">=</span>  <span class="n">bestAttemptContent</span> <span class="p">{</span>
            <span class="n">Kontext</span><span class="p">.</span><span class="n">serviceExtensionTimeWillExpireRequest</span><span class="p">(</span><span class="kc">self</span><span class="p">.</span><span class="n">receivedRequest</span><span class="p">,</span> <span class="n">with</span><span class="p">:</span> <span class="kc">self</span><span class="p">.</span><span class="n">bestAttemptContent</span><span class="p">)</span>
            <span class="n">contentHandler</span><span class="p">(</span><span class="n">bestAttemptContent</span><span class="p">)</span>
        <span class="p">}</span>
    <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<input name="__tabs_1" type="radio" id="__tab_1_1" />
<label for="__tab_1_1">Objective-C</label>
<div class="superfences-content"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#import &lt;Kontext/Kontext.h&gt;</span>

<span class="cp">#import &quot;NotificationService.h&quot;</span>

<span class="k">@interface</span> <span class="nc">NotificationService</span> <span class="p">()</span>

<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="n">contentHandler</span><span class="p">)(</span><span class="n">UNNotificationContent</span> <span class="o">*</span><span class="n">contentToDeliver</span><span class="p">);</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="n">UNNotificationRequest</span> <span class="o">*</span><span class="n">receivedRequest</span><span class="p">;</span>
<span class="k">@property</span> <span class="p">(</span><span class="k">nonatomic</span><span class="p">,</span> <span class="k">strong</span><span class="p">)</span> <span class="n">UNMutableNotificationContent</span> <span class="o">*</span><span class="n">bestAttemptContent</span><span class="p">;</span>

<span class="k">@end</span>

<span class="k">@implementation</span> <span class="nc">NotificationService</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">didReceiveNotificationRequest:</span><span class="p">(</span><span class="n">UNNotificationRequest</span> <span class="o">*</span><span class="p">)</span><span class="nv">request</span> <span class="nf">withContentHandler:</span><span class="p">(</span><span class="kt">void</span> <span class="p">(</span><span class="o">^</span><span class="p">)(</span><span class="n">UNNotificationContent</span> <span class="o">*</span> <span class="n">_Nonnull</span><span class="p">))</span><span class="nv">contentHandler</span> <span class="p">{</span>
    <span class="nb">self</span><span class="p">.</span><span class="n">receivedRequest</span> <span class="o">=</span> <span class="n">request</span><span class="p">;</span>
    <span class="nb">self</span><span class="p">.</span><span class="n">contentHandler</span> <span class="o">=</span> <span class="n">contentHandler</span><span class="p">;</span>
    <span class="nb">self</span><span class="p">.</span><span class="n">bestAttemptContent</span> <span class="o">=</span> <span class="p">[</span><span class="n">request</span><span class="p">.</span><span class="n">content</span> <span class="n">mutableCopy</span><span class="p">];</span>

    <span class="p">[</span><span class="n">Kontext</span> <span class="nl">didReceiveNotificationExtensionRequest</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">receivedRequest</span> <span class="nl">withMutableNotificationContent</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">bestAttemptContent</span><span class="p">];</span>

    <span class="c1">// DEBUGGING: Uncomment the 2 lines below and comment out the one above to ensure this extension is excuting</span>
    <span class="c1">//            Note, this extension only runs when mutable-content is set</span>
    <span class="c1">//            Setting an attachment or action buttons automatically adds this</span>
    <span class="c1">// NSLog(@&quot;Running NotificationServiceExtension&quot;);</span>
    <span class="c1">// self.bestAttemptContent.body = [@&quot;[Modified] &quot; stringByAppendingString:self.bestAttemptContent.body];</span>

    <span class="nb">self</span><span class="p">.</span><span class="n">contentHandler</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">bestAttemptContent</span><span class="p">);</span>
<span class="p">}</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">void</span><span class="p">)</span><span class="nf">serviceExtensionTimeWillExpire</span> <span class="p">{</span>
    <span class="c1">// Called just before the extension will be terminated by the system.</span>
    <span class="c1">// Use this as an opportunity to deliver your &quot;best attempt&quot; at modified content, otherwise the original push payload will be used.</span>

    <span class="p">[</span><span class="n">Kontext</span> <span class="nl">serviceExtensionTimeWillExpireRequest</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">receivedRequest</span> <span class="nl">withMutableNotificationContent</span><span class="p">:</span><span class="nb">self</span><span class="p">.</span><span class="n">bestAttemptContent</span><span class="p">];</span>

    <span class="nb">self</span><span class="p">.</span><span class="n">contentHandler</span><span class="p">(</span><span class="nb">self</span><span class="p">.</span><span class="n">bestAttemptContent</span><span class="p">);</span>
<span class="p">}</span>

<span class="k">@end</span>
</pre></div>
</td></tr></table></div>
</div>
<p><em>Ignore any build errors at this point, step 2 will import Kontext which will resolve any errors.</em></p>
<h3 id="2-import-kontext-into-your-xcode-project">2. Import Kontext into your Xcode project<a class="headerlink" href="#2-import-kontext-into-your-xcode-project" title="Permanent link">&para;</a></h3>
<p><a href="http://guides.cocoapods.org/using/getting-started.html">Setup CocoaPods</a> on your system if you don't have it already.</p>
<ul>
<li>Make sure you have version <code class="codehilite">1.1.0</code> or newer by running <code class="codehilite">pod --version</code> from the terminal.</li>
<li>Run the following to upgrade <code class="codehilite">sudo gem install cocoapods</code></li>
</ul>
<p><strong>2.1</strong> Make sure your current Xcode project is closed.</p>
<p><strong>2.2</strong> Run <code class="codehilite">pod init</code> from the terminal in your project directory.</p>
<p><strong>2.3</strong> Open the newly created <code class="codehilite">Podfile</code> with your favorite code editor such as Sublime.</p>
<p><strong>2.4</strong> Add <code class="codehilite">pod &#39;Kontext&#39;, &#39;&gt;= 2.5.2&#39;, &#39;&lt; 3.0&#39;</code> in your project name target as well as <code class="codehilite">KontextNotificationServiceExtension</code>.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>target &#39;project_name&#39; do
  pod &#39;Kontext&#39;, &#39;&gt;= 2.6.2&#39;, &#39;&lt; 3.0&#39;
end

target &#39;KontextNotificationServiceExtension&#39; do
  pod &#39;Kontext&#39;, &#39;&gt;= 2.6.2&#39;, &#39;&lt; 3.0&#39;
end
</pre></div>
</td></tr></table>

<p><strong>2.5</strong> Run the following from the terminal.</p>
<table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2</pre></div></td><td class="code"><div class="codehilite"><pre><span></span>pod repo update
pod install
</pre></div>
</td></tr></table>

<p><strong>2.6</strong> Open the newly created <code class="codehilite"><span class="na">.xcworkspace</span></code> file. <em>Make sure to always open the workspace from now on.</em> </p>
<p><strong>2.7</strong> Continue to Steps 3 and 4 below</p>
<h3 id="3-add-required-capabilities">3. Add Required Capabilities<a class="headerlink" href="#3-add-required-capabilities" title="Permanent link">&para;</a></h3>
<p><strong>3.1</strong> Select the root project and Under Capabilities Enable "Push Notifications".
<strong>3.2</strong> Next Enable "Background Modes" and check "Remote notifications".</p>
<h3 id="image_4">IMAGE<a class="headerlink" href="#image_4" title="Permanent link">&para;</a></h3>
<h3 id="4-add-required-code">4. Add Required Code<a class="headerlink" href="#4-add-required-code" title="Permanent link">&para;</a></h3>
<p>Add following Kontext initialization code to your <code class="codehilite">AppDelegate</code>.</p>
<div class="superfences-tabs">
<input name="__tabs_2" type="radio" id="__tab_2_0" checked="checked" />
<label for="__tab_2_0">Swift</label>
<div class="superfences-content"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="kd">import</span> <span class="nc">Kontext</span>

<span class="kd">func</span> <span class="nf">application</span><span class="p">(</span><span class="kc">_</span> <span class="n">application</span><span class="p">:</span> <span class="bp">UIApplication</span><span class="p">,</span> <span class="n">didFinishLaunchingWithOptions</span> <span class="n">launchOptions</span><span class="p">:</span> <span class="p">[</span><span class="n">UIApplicationLaunchOptionsKey</span><span class="p">:</span> <span class="nb">Any</span><span class="p">]?)</span> <span class="p">-&gt;</span> <span class="nb">Bool</span> <span class="p">{</span>

   <span class="kd">let</span> <span class="nv">kontextInitSettings</span> <span class="p">=</span> <span class="p">[</span><span class="n">kontextSettingsKeyAutoPrompt</span><span class="p">:</span> <span class="kc">false</span><span class="p">]</span>

   <span class="c1">// Replace &#39;YOUR_APP_ID&#39; with your Kontext App ID.</span>
   <span class="n">Kontext</span><span class="p">.</span><span class="n">initWithLaunchOptions</span><span class="p">(</span><span class="n">launchOptions</span><span class="p">,</span>
       <span class="n">appId</span><span class="p">:</span> <span class="s">&quot;YOUR_APP_ID&quot;</span><span class="p">,</span>
       <span class="n">handleNotificationAction</span><span class="p">:</span> <span class="kc">nil</span><span class="p">,</span>
       <span class="n">settings</span><span class="p">:</span> <span class="n">kontextInitSettings</span><span class="p">)</span>

   <span class="n">Kontext</span><span class="p">.</span><span class="n">inFocusDisplayType</span> <span class="p">=</span> <span class="n">KontextNotificationDisplayType</span><span class="p">.</span><span class="n">notification</span><span class="p">;</span>

   <span class="c1">// Recommend moving the below line to prompt for push after informing the user about</span>
   <span class="c1">//   how your app will use them.</span>
   <span class="n">Kontext</span><span class="p">.</span><span class="n">promptForPushNotifications</span><span class="p">(</span><span class="n">userResponse</span><span class="p">:</span> <span class="p">{</span> <span class="n">accepted</span> <span class="k">in</span>
      <span class="bp">print</span><span class="p">(</span><span class="s">&quot;User accepted notifications: </span><span class="si">\(</span><span class="n">accepted</span><span class="si">)</span><span class="s">&quot;</span><span class="p">)</span>
   <span class="p">})</span>

   <span class="k">return</span> <span class="kc">true</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
<input name="__tabs_2" type="radio" id="__tab_2_1" />
<label for="__tab_2_1">Objective-C</label>
<div class="superfences-content"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="cp">#import &lt;Kontext/Kontext.h&gt;</span>

<span class="k">@implementation</span> <span class="nc">AppDelegate</span>

<span class="p">-</span> <span class="p">(</span><span class="kt">BOOL</span><span class="p">)</span><span class="nf">application:</span><span class="p">(</span><span class="bp">UIApplication</span> <span class="o">*</span><span class="p">)</span><span class="nv">application</span> <span class="nf">didFinishLaunchingWithOptions:</span><span class="p">(</span><span class="bp">NSDictionary</span> <span class="o">*</span><span class="p">)</span><span class="nv">launchOptions</span> <span class="p">{</span>

   <span class="c1">// Replace &#39;11111111-2222-3333-4444-0123456789ab&#39; with your Kontext App ID.</span>
   <span class="p">[</span><span class="n">Kontext</span> <span class="nl">initWithLaunchOptions</span><span class="p">:</span><span class="n">launchOptions</span>
                              <span class="nl">appId</span><span class="p">:</span><span class="s">@&quot;11111111-2222-3333-4444-0123456789ab&quot;</span>
                 <span class="nl">handleNotificationAction</span><span class="p">:</span><span class="nb">nil</span>
                            <span class="nl">settings</span><span class="p">:</span><span class="l">@{</span><span class="nl">kontextSettingsKeyAutoPrompt</span><span class="p">:</span> <span class="p">@</span><span class="nb">false</span><span class="l">}</span><span class="p">];</span>
   <span class="n">Kontext</span><span class="p">.</span><span class="n">inFocusDisplayType</span> <span class="o">=</span> <span class="n">KontextNotificationDisplayTypeNotification</span><span class="p">;</span>

   <span class="c1">// Recommend moving the below line to prompt for push after informing the user about</span>
   <span class="c1">//   how your app will use them.</span>
   <span class="p">[</span><span class="n">Kontext</span> <span class="nl">promptForPushNotificationsWithUserResponse</span><span class="p">:</span><span class="o">^</span><span class="p">(</span><span class="kt">BOOL</span> <span class="n">accepted</span><span class="p">)</span> <span class="p">{</span>
        <span class="n">NSLog</span><span class="p">(</span><span class="s">@&quot;User accepted notifications: %d&quot;</span><span class="p">,</span> <span class="n">accepted</span><span class="p">);</span>
   <span class="p">}];</span>

   <span class="k">return</span> <span class="nb">YES</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="admonition info">
<p class="admonition-title">Note</p>
<p>Kontext <code class="codehilite">initWithLaunchOptions</code> must be called from your <code class="codehilite">didFinishLaunchingWithOptions</code>, as in the example above.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Troubleshooting</p>
<p>If run into any issues please see our <a href="../iOS/troubleshoot">iOS troubleshooting guide</a>.</p>
</div>
<h3 id="5-add-email">5. Add Email<a class="headerlink" href="#5-add-email" title="Permanent link">&para;</a></h3>
<p>RECOMMENDED</p>
<p>Next, if you collect emails from users, you can set a user's email with the <code class="codehilite">setEmail</code> method. This enables Kontext Email Messaging, which allows you to send emails in addition to push.</p>
<div class="superfences-tabs">
<input name="__tabs_3" type="radio" id="__tab_3_0" checked="checked" />
<label for="__tab_3_0">Swift</label>
<div class="superfences-content"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="n">Kontext</span><span class="p">.</span><span class="n">setEmail</span><span class="p">(</span><span class="s">&quot;example@domain.com&quot;</span><span class="p">);</span>
</pre></div>
</td></tr></table></div>
<input name="__tabs_3" type="radio" id="__tab_3_1" />
<label for="__tab_3_1">Objective-C</label>
<div class="superfences-content"><table class="codehilitetable"><tr><td class="linenos"><div class="linenodiv"><pre>1</pre></div></td><td class="code"><div class="codehilite"><pre><span></span><span class="p">[</span><span class="n">Kontext</span> <span class="nl">setEmail</span><span class="p">:</span><span class="s">@&quot;example@domain.com&quot;</span><span class="p">];</span>
</pre></div>
</td></tr></table></div>
</div>
<h3 id="6-add-app-groups-optional-but-recommended">6. Add App Groups (Optional but Recommended)<a class="headerlink" href="#6-add-app-groups-optional-but-recommended" title="Permanent link">&para;</a></h3>
<p>In order for your application to be able to let push notifications increment/decrement the badge count, you need to set up an <strong>App Group</strong> for your application.</p>
<h3 id="callbacks">Callbacks<a class="headerlink" href="#callbacks" title="Permanent link">&para;</a></h3>
<p><a href="../iOS/reference/#kontexthandlenotificationreceivedblock">KontextHandleNotificationReceivedBlock</a> - Called when a notification is received while your app is in focus only.
<a href="../iOS/reference/#kontexthandlenotificationactionblock">KontextHandleNotificationActionBlock</a> - This will be called when a notification is tapped on.
See our <a href="../iOS/reference/#initwithlaunchoptions">initWithLaunchOptions</a> documentation to add these.</p>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../iOS-quickstart/" title="iOS Quickstart" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                iOS Quickstart
              </span>
            </div>
          </a>
        
        
          <a href="../gdpr/" title="GDPR" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                GDPR
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
          <div class="md-footer-copyright__highlight">
            Copyright &copy; 2016 - 2018 Adpin Technologies Pvt. Ltd.
          </div>
        
      </div>
      
        
  <div class="md-footer-social">
    <link rel="stylesheet" href="../assets/fonts/font-awesome.css">
    
      <a href="http://struct.cc" class="md-footer-social__link fa fa-globe"></a>
    
      <a href="https://github.com/kontext" class="md-footer-social__link fa fa-github-alt"></a>
    
      <a href="https://twitter.com/yourkontext" class="md-footer-social__link fa fa-twitter"></a>
    
      <a href="https://linkedin.com/in/kontext" class="md-footer-social__link fa fa-linkedin"></a>
    
  </div>

      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.150a6ebd.js"></script>
      
      <script>app.initialize({version:"0.17.4",url:{base:".."}})</script>
      
    
    
      
        <script>!function(e,a,t,n,o,c,i){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,c=a.createElement(t),i=a.getElementsByTagName(t)[0],c.async=1,c.src="https://www.google-analytics.com/analytics.js",i.parentNode.insertBefore(c,i)}(window,document,"script",0,"ga"),ga("create","None","auto"),ga("set","anonymizeIp",!0),ga("send","pageview");var links=document.getElementsByTagName("a");if(Array.prototype.map.call(links,function(e){e.host!=document.location.host&&e.addEventListener("click",function(){var a=e.getAttribute("data-md-action")||"follow";ga("send","event","outbound",a,e.href)})}),document.forms.search){var query=document.forms.search.query;query.addEventListener("blur",function(){if(this.value){var e=document.location.pathname;ga("send","pageview",e+"?q="+this.value)}})}</script>
      
    
  </body>
</html>